// Modified 2023-08-17

// Station Science Expansion
@CONTRACT_TYPE[ScienceLab]:Final
{
    @title = Add a Mobile Processing Lab MPL-LG-2 to @/targetVessel1
    @genericTitle = Space Station Science Expansion
    @rewardFunds = Random(200000.0, 250000.0)
    @description = Now that we know we can survive in space for a few days, we should try to do more science up there.
    @genericDescription = We need to send a science lab to the station for our guys up there to play with.
    @synopsis = Add a new Science Lab to @/targetVessel1 .
    @completedMessage = Well done! Now we can continue advancing Human-kind!
    @DATA::HAS[#type[Vessel]]
    {
        @uniquenessCheck = CONTRACT_ALL
        @targetVessel1 = AllVessels().Where(v => v.VesselType() == Station && v.CrewCount() > 0).SelectUnique()
        @title = Must have a station without a science lab
    }
    @PARAMETER[PartValidation]
    {
        @title = Launch a Have a Science Lab to @/targetVessel1 .
        !VALIDATE{}
        partModule = ModuleScienceLab
        minCount = 1	
    }
}

CONTRACT_TYPE:NEEDS[!StationScience&!Kerbalism]
{
    name = LargeScienceLab
    title = Add a Large Station Lab  to @/targetVessel1
    genericTitle = Add a Add a Large Station Lab to the Station
    group = BasesandStations
    description = Now that we know we can survive in space for a few days, we should try to do more science up there.
    genericDescription = How are we gonna do science without a lab, huh?
    synopsis = Add a Add a Large Station Lab  to @/targetVessel1 .
    completedMessage = Well done! Now we can continue advancing Kerbal-kind!
    
    minExpiry = 1
    maxExpiry = 7
    
    cancellable = true
    declinable = true
    maxSimultaneous = 1
    
    rewardScience = 0.0
    rewardReputation = 1.0
    rewardFunds = Random(200000.0, 250000.0)
    failureReputation = 1.0
    failureFunds = 35000.0
    advanceFunds = 35000.0
    
    targetBody = @/targetBody1
    
    //Find a Station without a Large Station Lab 
    DATA
    {
        type = Vessel
        uniquenessCheck = CONTRACT_ACTIVE
        requiredValue = true
        targetVessel1 = AllVessels().Where(v => v.Parts().Contains(LargerCrewedLabAr) == false && v.VesselType() == Station && v.CrewCount() > 0).Random()
        title = Must have a station without a Large Station Lab .
    }

    DATA
    {
        type = CelestialBody
        requiredValue = true
        targetBody1 = @/targetVessel1.CelestialBody()
        hidden = true
    }
    

    PARAMETER
    {
        name = PartValidation
        type = PartValidation
        title = Launch a new Large Station Lab to @/targetVessel1 .
        VALIDATE
        {
            part = LargerCrewedLabAr
        }
    }

    PARAMETER
    {
        name = Docking
        type = Docking
        vessel = @/targetVessel1
        title = Dock with @/targetVessel1
        hideChildren = true
        completeInSequence = true
    }
    
    REQUIREMENT
    {
        name = PartUnlocked
        type = PartUnlocked
        checkOnActiveContract = false
        part = LargerCrewedLabAr
    }
}
