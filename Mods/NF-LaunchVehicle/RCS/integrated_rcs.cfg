Modified 2025-12-06
// AVCS-3 Integrated RCS Block

@PART[nflv-rcs-integrated-3x-1]:Final
{
    @cost *= 0.1

    !MODULE[ModuleB9PartSwitch]:HAS[#moduleID[RCS]],*{}
    !MODULE[ModuleB9DisableTransform] {}
    MODULE
    {
        name = ModuleB9PartSwitch
        moduleID = RCS
        switcherDescription = Propellant Options
        switcherDescriptionPlural = Propellant Options
        switchInFlight = False
        SUBTYPE
        {
            name = Hydrolox1
            title = Hydrolox
            primaryColor = ResourceColorLqdHydrogen
            secondaryColor = ResourceColorOxidizer
            descriptionDetail = #Uses Boiled off LH2 and LOX for high efficiency RCS thrusters and fuel cells.<br><b>Thruster Power:</b> 0.8KN<br><b>Isp:</b> 200s (ASL) / 360s (Vac).
            transform = ACES3xLH2
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleRCSFX
                }
                DATA
                {
                    thrusterPower = 0.8
                    runningEffectName = running-lh2
                    PROPELLANT
                    {
                        name = LqdHydrogen
                        ratio = 0.7276
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    PROPELLANT
                    {
                        name = LqdOxygen
                        ratio = 0.2724
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    atmosphereCurve
                    {
                        key = 0 360
                        key = 1 200
                        key = 4 0.001
                    }
                }
            }
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleResourceConverter
                }
                DATA
                {
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdHydrogen
                        Ratio = 0.0027285
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdOxygen
                        Ratio = 0.0010215
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                }
            }
        }
        SUBTYPE
        {
            name = Methalox1
            title = Methalox
            primaryColor = ResourceColorLqdMethane
            secondaryColor = ResourceColorOxidizer
            descriptionDetail = #Uses Methalox for efficient RCS thrusters.<br><b>Thruster Power:</b> 1KN<br><b>Isp:</b> 180s (ASL) / 300s (Vac).
            transform = ACES3xLF
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleRCSFX
                }
                DATA
                {
                    thrusterPower = 1
                    PROPELLANT
                    {
                        name = LqdMethane
                        ratio = 0.4137
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    PROPELLANT
                    {
                        name = LqdOxygen
                        ratio = 0.5863
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    atmosphereCurve
                    {
                        key = 0 300
                        key = 1 180
                        key = 4 0.001
                    }
                }
            }
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleResourceConverter
                }
                DATA
                {
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdMethane
                        Ratio = 0.001551375
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdOxygen
                        Ratio = 0.002198625
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                }
            }
        }
    }
}

@PART[nflv-rcs-integrated-3x-1]:Final
{
    !EFFECTS {}
    EFFECTS
    {
        running
        {
            AUDIO_MULTI_POOL
            {
                channel = Ship
                transformName = thrustVector
                clip = sound_rocket_mini
                volume = 0.0 0.0
                volume = 0.1 0.0
                volume = 0.5 0.025
                volume = 1.0 0.1
                pitch = 0.0 0.75
                pitch = 1.0 1.5
                loop = true
            
            }
        }
        running-ch4
        {
            AUDIO_MULTI_POOL
            {
                channel = Ship
                transformName = thrustVector
                clip = sound_rocket_mini
                volume = 0.0 0.0
                volume = 0.1 0.0
                volume = 0.5 0.025
                volume = 1.0 0.1
                pitch = 0.0 0.75
                pitch = 1.0 1.5
                loop = true
            }
        }
        running-lh2
        {
            AUDIO_MULTI_POOL
            {
                channel = Ship
                transformName = thrustVector
                clip = sound_rocket_mini
                volume = 0.0 0.0
                volume = 0.1 0.0
                volume = 0.5 0.025
                volume = 1.0 0.1
                pitch = 0.0 0.75
                pitch = 1.0 1.5
                loop = true
            }
        }
    }

    !MODULE[ModuleWaterfallFX] {}
    MODULE
    {
        name = ModuleWaterfallFX
        // This is a custom name
        moduleID = rcsFX
        // This links the effects to a given ModuleEngines
        engineID = basicEngine

        // List out all controllers we want available
        CONTROLLER
        {
            name = atmosphereDepth
            linkedTo = atmosphere_density
        }
        CONTROLLER
        {
            name = rcs
            linkedTo = rcs
        }

        TEMPLATE
        {
            // This is the name of the template to use
            templateName = waterfall-rcs-nflv-lfo-1
            // This field allows you to override the parentTransform name in the EFFECTS contained in the template
            overrideParentTransform = fxVector
            position = 0,-0.01,0
            rotation = 0, 0, 180
            scale = 0.95, 1, 0.95
        }
    }

    @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[RCS]]
    {
        @SUBTYPE[Hydrolox1]
        {
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleWaterfallFX
                }
                DATA
                {
                    TEMPLATE
                    {
                        // This is the name of the template to use
                        templateName = waterfall-rcs-nflv-lh2-1
                        // This field allows you to override the parentTransform name in the EFFECTS contained in the template
                        overrideParentTransform = fxVector
                        position = 0,-0.01,0
                        rotation = 0, 0, 180
                        scale = 0.95, 1.5, 0.95
                    }
                }
            }
        }
        @SUBTYPE[Methalox1]
        {
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleWaterfallFX
                }
                DATA
                {
                    TEMPLATE
                    {
                        // This is the name of the template to use
                        templateName = waterfall-rcs-nflv-ch4-1
                        // This field allows you to override the parentTransform name in the EFFECTS contained in the template
                        overrideParentTransform = fxVector
                        position = 0,-0.01,0
                        rotation = 0, 0, 180
                        scale = 0.95, 1.2, 0.95
                    }
                }
            }
        }
    }

}

// AVCS-4 Integrated RCS Block
@PART[nflv-rcs-integrated-4x-1]:Final
{
    @cost *= 0.1
    @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[RCS]] 
    {
        !SUBTYPE,*{}
        SUBTYPE
        {
            name = Hydrolox
            title = Hydrolox
            primaryColor = ResourceColorLqdHydrogen
            secondaryColor = ResourceColorOxidizer
            descriptionDetail = #Uses Boiled off LH2 and LOX for high efficiency RCS thrusters and fuel cells.<br><b>Thruster Power:</b> 0.8KN<br><b>Isp:</b> 200s (ASL) / 360s (Vac).
            transform = ACES4xLH2
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleRCSFX
                }
                DATA
                {
                    thrusterPower = 0.8
                    runningEffectName = running-lh2
                    PROPELLANT
                    {
                        name = LqdHydrogen
                        ratio = 0.7276
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    PROPELLANT
                    {
                        name = LqdOxygen
                        ratio = 0.2724
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    atmosphereCurve
                    {
                        key = 0 360
                        key = 1 200
                        key = 4 0.001
                    }
                }
            }
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleResourceConverter
                }
                DATA
                {
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdHydrogen
                        Ratio = 0.0027285
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdOxygen
                        Ratio = 0.0010215
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                }
            }
        }
        SUBTYPE
        {
            name = Methalox
            title = Methalox
            primaryColor = ResourceColorLqdMethane
            secondaryColor = ResourceColorOxidizer
            descriptionDetail = #Uses Methalox for efficient RCS thrusters.<br><b>Thruster Power:</b> 1KN<br><b>Isp:</b> 180s (ASL) / 300s (Vac).
            transform = ACES4xLF
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleRCSFX
                }
                DATA
                {
                    thrusterPower = 1
                    PROPELLANT
                    {
                        name = LqdMethane
                        ratio = 0.4137
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    PROPELLANT
                    {
                        name = LqdOxygen
                        ratio = 0.5863
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    atmosphereCurve
                    {
                        key = 0 300
                        key = 1 180
                        key = 4 0.001
                    }
                }
            }
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleResourceConverter
                }
                DATA
                {
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdMethane
                        Ratio = 0.001551375
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdOxygen
                        Ratio = 0.002198625
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                }
            }
        }
    }
}

// AVCS-4A Integrated RCS Block
@PART[nflv-rcs-integrated-4x-2]:Final
{
    @cost *= 0.1
    @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[RCS]] 
    {
        !SUBTYPE,*{}
        SUBTYPE
        {
            name = Hydrolox
            title = Hydrolox
            primaryColor = ResourceColorLqdHydrogen
            secondaryColor = ResourceColorOxidizer
            descriptionDetail = #Uses Boiled off LH2 and LOX for high efficiency RCS thrusters and fuel cells.<br><b>Thruster Power:</b> 0.8KN<br><b>Isp:</b> 200s (ASL) / 360s (Vac).
            transform = ACES4xALH2
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleRCSFX
                }
                DATA
                {
                    thrusterPower = 0.8
                    runningEffectName = running-lh2
                    PROPELLANT
                    {
                        name = LqdHydrogen
                        ratio = 0.7276
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    PROPELLANT
                    {
                        name = LqdOxygen
                        ratio = 0.2724
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    atmosphereCurve
                    {
                        key = 0 360
                        key = 1 200
                        key = 4 0.001
                    }
                }
            }
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleResourceConverter
                }
                DATA
                {
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdHydrogen
                        Ratio = 0.0027285
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdOxygen
                        Ratio = 0.0010215
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                }
            }
        }
        SUBTYPE
        {
            name = Methalox
            title = Methalox
            primaryColor = ResourceColorLqdMethane
            secondaryColor = ResourceColorOxidizer
            descriptionDetail = #Uses Methalox for efficient RCS thrusters.<br><b>Thruster Power:</b> 1KN<br><b>Isp:</b> 180s (ASL) / 300s (Vac).
            transform = ACES4xALF
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleRCSFX
                }
                DATA
                {
                    thrusterPower = 1
                    PROPELLANT
                    {
                        name = LqdMethane
                        ratio = 0.4137
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    PROPELLANT
                    {
                        name = LqdOxygen
                        ratio = 0.5863
                        resourceFlowMode = STAGE_PRIORITY_FLOW
                    }
                    atmosphereCurve
                    {
                        key = 0 300
                        key = 1 180
                        key = 4 0.001
                    }
                }
            }
            MODULE
            {
                IDENTIFIER
                {
                    name = ModuleResourceConverter
                }
                DATA
                {
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdMethane
                        Ratio = 0.001551375
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                    INPUT_RESOURCE
                    {
                        ResourceName = LqdOxygen
                        Ratio = 0.002198625
                        FlowMode = STAGE_PRIORITY_FLOW
                    }
                }
            }
        }
    }
}
